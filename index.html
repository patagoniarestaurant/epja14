<!DOCTYPE html>
<html lang="es">
<head>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Patagonia Restaurant — Menú Digital</title>

<!-- Fuentes + FontAwesome -->
<link href="https://fonts.googleapis.com/css2?family=Sanchez&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- jsPDF para comprobante -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<!-- Google Translate -->
<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<style>
  :root{
    --bg:#000000; --surface:#000000; --surface-light:#1a1a1a; --text:#ffffff;
    --text-muted:#a0a0a0; --accent:#d4af37; --accent-dark:#b8941f; --radius:12px;
    --border:rgba(255,255,255,0.08); --shadow:0 10px 25px rgba(0,0,0,0.5); --transition:all .25s ease;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;font-family:'Sanchez',serif;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}
  .container{max-width:1100px;margin:0 auto;padding:12px}
  header{position:sticky;top:0;background:rgba(0,0,0,.95);border-bottom:1px solid var(--border);padding:12px 0;z-index:100}
  .header-content{display:flex;align-items:center;justify-content:space-between}
  .brand{display:flex;gap:12px;align-items:center}
  .hamburger-menu{display:flex;flex-direction:column;gap:4px;cursor:pointer;padding:6px}
  .hamburger-menu span{width:22px;height:2px;background:var(--accent)}
  .restaurant-cover{width:60px;height:50px;border-radius:8px;object-fit:cover;border:2px solid var(--accent)}
  .brand-text h1{font-size:16px;color:var(--text)}
  .nav-buttons{display:flex;gap:10px;margin:12px 0}
  .nav-btn{background:var(--accent);color:var(--text);padding:10px 12px;border-radius:10px;border:1px solid var(--accent);cursor:pointer;transition:var(--transition)}
  .nav-btn:hover{background:var(--accent-dark)}
  .view{display:none}
  .view.active{display:block}
  .cover-image{width:100%;height:150px;object-fit:cover;border-radius:var(--radius);margin-bottom:12px}
  .profile-section{text-align:center;margin-bottom:12px}
  .profile-image{width:100px;height:100px;border-radius:50%;object-fit:cover;border:4px solid var(--accent);margin:0 auto 8px}
  .contact-info,.hours-section,.customer-category,.category-section{background:var(--surface);padding:12px;border-radius:12px;margin-bottom:12px;border:1px solid var(--border)}
  .menu-section{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
  .dishes-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
  .dish-card{background:var(--surface-light);border-radius:12px;overflow:hidden;border:1px solid var(--border);display:flex;flex-direction:column;cursor:pointer;aspect-ratio:1;transition:var(--transition)}
  .dish-card.selected{border:2px solid var(--accent);box-shadow:0 0 15px var(--accent)}
  .dish-image{height:65%;position:relative}
  .dish-image img{width:100%;height:100%;object-fit:cover}
  .dish-content{padding:8px;display:flex;flex-direction:column;justify-content:space-between;flex:1}
  .dish-header{display:flex;justify-content:space-between;align-items:flex-start}
  .dish-name{font-weight:700;color:var(--accent)}
  .dish-price{color:var(--accent);font-weight:800}
  .dish-actions{display:flex;justify-content:space-between;align-items:center;margin-top:8px}
  .qty-btn{width:28px;height:28px;border-radius:50%;border:1px solid var(--border);background:transparent;cursor:pointer;color:var(--accent)}
  .add-to-cart-btn{background:var(--accent);color:var(--bg);border:none;padding:6px 10px;border-radius:10px;cursor:pointer}
  .sidebar-nav{position:fixed;left:-320px;top:0;width:320px;height:100vh;background:var(--surface);padding:12px;border-right:1px solid var(--border);transition:var(--transition);z-index:1200;overflow-y:auto}
  .sidebar-nav.open{left:0}
  .sidebar-overlay{position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.5);opacity:0;visibility:hidden;transition:var(--transition);z-index:1100}
  .sidebar-overlay.open{opacity:1;visibility:visible}
  .modal,.dish-detail-modal,.payment-choice-modal,.registration-modal,.login-modal{position:fixed;left:0;top:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.7);z-index:1400;opacity:0;visibility:hidden;transition:var(--transition)}
  .modal.open,.dish-detail-modal.open,.payment-choice-modal.open,.registration-modal.open,.login-modal.open{opacity:1;visibility:visible}
  .modal-content,.dish-detail-content{background:var(--surface);padding:16px;border-radius:12px;max-width:520px;width:95%;max-height:90vh;overflow:auto}
  .calculator{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
  .calculator-display{grid-column:1/-1;background:var(--surface-light);padding:10px;border-radius:8px;border:1px solid var(--border);text-align:right}
  .calculator-btn{padding:12px;border-radius:8px;border:1px solid var(--border);background:transparent;cursor:pointer;color:var(--accent)}
  .toast{position:fixed;right:16px;bottom:16px;padding:10px 14px;border-radius:8px;background:var(--surface);border-left:4px solid var(--accent);transform:translateY(40px);opacity:0;transition:var(--transition);z-index:1600}
  .toast.show{transform:translateY(0);opacity:1}
  .hidden{display:none!important}
  footer{background:var(--surface);padding:20px;margin-top:20px;border-top:1px solid var(--border);text-align:center}
  .customer-categories{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
  .customer-category{background:var(--surface);padding:12px;border-radius:12px;border:1px solid var(--border)}
  .customer-category h3{color:var(--accent);text-align:center;margin-bottom:8px}
  .customer-item{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--border)}
  .customer-item:last-child{border-bottom:none}
  .filter-section{background:var(--surface);padding:12px;border-radius:12px;margin-bottom:12px;border:1px solid var(--border)}
  .filter-options{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
  .filter-tag{background:var(--surface-light);color:var(--text);padding:6px 12px;border-radius:20px;border:1px solid var(--border);cursor:pointer;transition:var(--transition)}
  .filter-tag.selected{background:var(--accent);color:var(--bg)}
  .split-calculator{margin-top:12px;padding:12px;background:var(--surface-light);border-radius:8px;border:1px solid var(--border)}
  .split-options{display:grid;grid-template-columns:repeat(6,1fr);gap:6px;margin-top:8px}
  .split-option{background:var(--surface);color:var(--text);padding:8px;border-radius:8px;border:1px solid var(--border);cursor:pointer;text-align:center;transition:var(--transition)}
  .split-option.selected{background:var(--accent);color:var(--bg)}
  .category-carousel{display:flex;overflow-x:auto;gap:12px;padding:8px 0;scroll-snap-type:x mandatory}
  .category-carousel::-webkit-scrollbar{height:6px}
  .category-carousel::-webkit-scrollbar-track{background:var(--surface-light);border-radius:3px}
  .category-carousel::-webkit-scrollbar-thumb{background:var(--accent);border-radius:3px}
  .category-carousel-item{flex:0 0 auto;width:calc(50% - 6px);scroll-snap-align:start}
  .favorites-section{margin-top:16px;padding-top:16px;border-top:1px solid var(--border)}
  .favorite-item{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--border)}
  .favorite-item:last-child{border-bottom:none}
  .favorite-vote{display:flex;gap:4px;align-items:center}
  .vote-btn{background:transparent;border:none;color:var(--accent);cursor:pointer;font-size:16px}
  .vote-count{min-width:20px;text-align:center}
  .price-inputs{display:flex;gap:8px}
  .price-inputs input{flex:1;padding:8px;border-radius:8px;background:var(--surface-light);border:1px solid var(--border);color:var(--text);width:100%}
  .language-selector{position:fixed;top:10px;right:10px;z-index:1000}
  .language-selector select{padding:6px 10px;border-radius:8px;background:var(--surface);color:var(--text);border:1px solid var(--border);cursor:pointer}
  @media(max-width:800px){
    .menu-section,.dishes-grid{grid-template-columns:repeat(1,1fr)} 
    .dish-card{aspect-ratio:1.5} 
    .restaurant-cover{display:none}
    .customer-categories{grid-template-columns:1fr}
    .split-options{grid-template-columns:repeat(3,1fr)}
    .category-carousel-item{width:calc(100% - 6px)}
    .language-selector{right:10px;top:80px}
  }
  @media(max-width:480px){
    .dishes-grid{grid-template-columns:repeat(2,1fr)}
    .dish-card{aspect-ratio:1}
    .category-carousel-item{width:calc(100% - 6px)}
  }

  /* Google Translate Styles */
  .goog-te-banner-frame { display: none !important; }
  .goog-te-gadget-simple { background: var(--surface) !important; border: 1px solid var(--border) !important; padding: 6px 10px !important; border-radius: 8px !important; }
  .goog-te-gadget-simple span { color: var(--text) !important; }
  .goog-te-menu-value span { color: var(--text) !important; }
  .goog-te-menu2 { background: var(--surface) !important; border: 1px solid var(--border) !important; }
  .goog-te-menu2-item div, .goog-te-menu2-item-selected div { color: var(--text) !important; }
  .goog-te-menu2-item:hover { background: var(--surface-light) !important; }
  #google_translate_element { position: fixed; top: 10px; right: 10px; z-index: 1000; }
  body { top: 0px !important; }
</style>

<script>
  // CONFIGURACIÓN DE FIREBASE
  const firebaseConfig = {
    apiKey: "AIzaSyBSTjM-uPnnqIvcDBkpf71yxF6ajga1db0",
    authDomain: "patagoniarestaurant-783c3.firebaseapp.com",
    databaseURL: "https://patagoniarestaurant-783c3-default-rtdb.firebaseio.com",
    projectId: "patagoniarestaurant-783c3",
    storageBucket: "patagoniarestaurant-783c3.firebasestorage.app",
    messagingSenderId: "303237107477",
    appId: "1:303237107477:web:67591dad3e4244d434a31c"
  };

  // Inicializar Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Google Translate
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage: 'es',
      includedLanguages: 'es,en,fr,de,it,pt,ja,zh,ru,ar',
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
      autoDisplay: false
    }, 'google_translate_element');
  }
</script>
</head>
<body>

<!-- TOAST -->
<div id="toast" class="toast"></div>

<!-- Google Translate -->
<div id="google_translate_element"></div>

<!-- SIDEBAR -->
<div id="sidebarOverlay" class="sidebar-overlay"></div>
<aside id="sidebarNav" class="sidebar-nav" aria-hidden="true">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
    <h3 style="color:var(--accent)">Menú</h3>
    <button id="closeSidebar" class="nav-btn"><i class="fas fa-times"></i></button>
  </div>

  <div style="margin-bottom:10px;display:flex;flex-direction:column;gap:8px">
    <button id="sidebarLoginBtn" class="nav-btn"><i class="fas fa-sign-in-alt"></i> Iniciar Sesión</button>
    <button id="sidebarRegisterBtn" class="nav-btn"><i class="fas fa-user-plus"></i> Registrarse</button>
  </div>

  <div style="margin-bottom:10px">
    <div style="position:relative">
      <i class="fas fa-search" style="position:absolute;left:10px;top:10px;color:var(--text-muted)"></i>
      <input id="sidebarSearch" style="width:100%;padding:10px 12px 10px 36px;border-radius:8px;background:var(--surface-light);border:1px solid var(--border);color:var(--text)" placeholder="Buscar platos...">
    </div>
  </div>

  <div class="filter-section">
    <h4 style="color:var(--accent);margin-bottom:8px">Filtrar por precio</h4>
    <div class="price-inputs">
      <input id="minPrice" type="number" placeholder="Mín" style="width:100%">
      <input id="maxPrice" type="number" placeholder="Máx" style="width:100%">
    </div>
    <div style="display:flex;gap:8px;margin-top:8px">
      <button id="applyPriceFilter" class="nav-btn" style="flex:1">Aplicar</button>
      <button id="clearPriceFilter" class="nav-btn" style="flex:1">Limpiar</button>
    </div>
  </div>

  <div class="filter-section">
    <h4 style="color:var(--accent);margin-bottom:8px">Etiquetas de alimentos</h4>
    <div class="filter-options" id="foodTags">
      <div class="filter-tag" data-tag="vegetariano">Vegetariano</div>
      <div class="filter-tag" data-tag="vegano">Vegano</div>
      <div class="filter-tag" data-tag="sin-gluten">Sin Gluten</div>
      <div class="filter-tag" data-tag="picante">Picante</div>
      <div class="filter-tag" data-tag="bajo-calorias">Bajo Calorías</div>
    </div>
  </div>

  <div id="categoriesSidebar" style="display:flex;flex-direction:column;gap:8px"></div>

  <div class="favorites-section">
    <h4 style="color:var(--accent);margin-bottom:8px">Platos Favoritos</h4>
    <div id="favoritesList"></div>
  </div>
</aside>

<!-- CART -->
<div id="cartOverlay" class="cart-overlay"></div>
<aside id="cartSidebar" class="cart-sidebar" aria-hidden="true">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
    <h3 style="color:var(--accent)">Tu Pedido</h3>
    <button id="closeCart" class="nav-btn"><i class="fas fa-times"></i></button>
  </div>
  <div id="cartItems" style="max-height:55vh;overflow:auto"></div>
  <div style="border-top:1px solid var(--border);padding-top:12px;margin-top:12px">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <strong>Total:</strong><strong id="cartTotal">$0</strong>
    </div>
    <button id="checkoutBtn" class="nav-btn" style="width:100%;background:var(--accent);color:var(--bg)">Proceder al Pago</button>
    <div id="pendingPayment" class="hidden" style="margin-top